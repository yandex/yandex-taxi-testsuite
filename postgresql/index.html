
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>PostgreSQL &#8212; yandex-taxi-testsuite 0.1.35 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments_pytest.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="MySQL" href="../mysql/" />
    <link rel="prev" title="Mongo" href="../mongo/" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="postgresql">
<h1>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this heading">¶</a></h1>
<p>In order to enable postgres support you have to add
<code class="docutils literal notranslate"><span class="pre">testsuite.database.pgsql_plugin</span></code> to <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> list in your
<code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file and configure postgresql schemas location.</p>
<p>By default testsuite starts <a class="reference external" href="https://www.postgresql.org/">PostgreSQL</a> service. In this case
PostgreSQL installation is required.</p>
<p>Currently pgsql plugin uses synchronous <a class="reference external" href="https://pypi.org/project/psycopg2/">psycopg2</a> driver.</p>
<p>Pgsql plugin creates database schema once. And then populates database
with data fixtures on each test. It looks for database fixtures by the
following names:</p>
<ul class="simple">
<li><p>file <code class="docutils literal notranslate"><span class="pre">pg_DBNAME.sql</span></code></p></li>
<li><p>directory <code class="docutils literal notranslate"><span class="pre">pg_DBNAME/</span></code></p></li>
</ul>
<section id="customize-port">
<h2>Customize port<a class="headerlink" href="#customize-port" title="Permalink to this heading">¶</a></h2>
<p>Testsuite may start postgres with custom port, if <code class="docutils literal notranslate"><span class="pre">TESTSUITE_POSTGRESQL_PORT</span></code>
environment variable is specified</p>
</section>
<section id="use-external-instance">
<h2>Use external instance<a class="headerlink" href="#use-external-instance" title="Permalink to this heading">¶</a></h2>
<p>You can force it to use your own postgres installation with command-line option
<code class="docutils literal notranslate"><span class="pre">--postgresql=postgresql://db-postgresql/</span></code>.</p>
</section>
<section id="reuse-database-between-simultaneous-sessions">
<h2>Reuse database between simultaneous sessions<a class="headerlink" href="#reuse-database-between-simultaneous-sessions" title="Permalink to this heading">¶</a></h2>
<p>In general, testsuite does not support running simultaneous sessions, except
when testsuite is started with <code class="docutils literal notranslate"><span class="pre">--postgresql-keep-existing-db</span></code> or
<code class="docutils literal notranslate"><span class="pre">--service-runner-mode</span></code> flag.</p>
<p>In service runner mode testsuite starts the service and waits indefinitely
so that developer can attach to running service with debugger.</p>
<p>If one session in service runner mode creates database and applies schemas,
then the next one will skip applying schemas on initialization, unless schemas
were modified since then.</p>
</section>
<section id="example-integration">
<h2>Example integration<a class="headerlink" href="#example-integration" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testsuite.databases.pgsql</span> <span class="kn">import</span> <span class="n">discover</span>

<span class="n">pytest_plugins</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;testsuite.pytest_plugin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;testsuite.databases.pgsql.pytest_plugin&#39;</span><span class="p">,</span>
<span class="p">]</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s1">&#39;session&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pgsql_local</span><span class="p">(</span><span class="n">pgsql_local_create</span><span class="p">):</span>
    <span class="n">tests_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">sqldata_path</span> <span class="o">=</span> <span class="n">tests_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;../schemas/postgresql&#39;</span><span class="p">)</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="n">discover</span><span class="o">.</span><span class="n">find_schemas</span><span class="p">(</span><span class="s1">&#39;service_name&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">sqldata_path</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pgsql_local_create</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">databases</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</section>
<section id="database-access-example">
<h2>Database access example<a class="headerlink" href="#database-access-example" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_read_from_database</span><span class="p">(</span><span class="n">pgsql</span><span class="p">):</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">pgsql</span><span class="p">[</span><span class="s1">&#39;chat_messages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="s1">&#39;SELECT username, text FROM messages WHERE id = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],),</span>
    <span class="p">)</span>
    <span class="n">record</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">record</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this heading">¶</a></h2>
<section id="testsuite-postgresql-port">
<h3>TESTSUITE_POSTGRESQL_PORT<a class="headerlink" href="#testsuite-postgresql-port" title="Permalink to this heading">¶</a></h3>
<p>Use to override Postgresql server port. Default is <code class="docutils literal notranslate"><span class="pre">15433</span></code>.</p>
</section>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h2>
<section id="find-schemas">
<h3>find_schemas<a class="headerlink" href="#find-schemas" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.discover.find_schemas">
<span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.discover.</span></span><span class="sig-name descname"><span class="pre">find_schemas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_dirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.12)"><span class="pre">Path</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PgShardedDatabase</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/discover/#find_schemas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.discover.find_schemas" title="Permalink to this definition">¶</a></dt>
<dd><p>Read database schemas from directories <code class="docutils literal notranslate"><span class="pre">schema_dirs</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|-</span> <span class="n">schema_path</span><span class="o">/</span>
  <span class="o">|-</span> <span class="n">database1</span><span class="o">.</span><span class="n">sql</span>
  <span class="o">|-</span> <span class="n">database2</span><span class="o">.</span><span class="n">sql</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service_name</strong> – service name used as prefix for database name if not
empty, e.g. “servicename_dbname”.</p></li>
<li><p><strong>schema_dirs</strong> – list of pathes to scan for schemas</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">PgShardedDatabase]</span></code> where key is
database name as stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">PgShard.dbname</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="fixtures">
<h2>Fixtures<a class="headerlink" href="#fixtures" title="Permalink to this heading">¶</a></h2>
<section id="pgsql">
<h3>pgsql<a class="headerlink" href="#pgsql" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.pgsql">
<span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.pytest_plugin.</span></span><span class="sig-name descname"><span class="pre">pgsql</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#pgsql"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.pgsql" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns str to
<a class="reference internal" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper" title="testsuite.databases.pgsql.control.PgDatabaseWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">testsuite.databases.pgsql.control.PgDatabaseWrapper</span></code></a> dictionary</p>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_pg</span><span class="p">(</span><span class="n">pgsql</span><span class="p">):</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">pgsql</span><span class="p">[</span><span class="s1">&#39;example_db&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT ... FROM ...WHERE ...&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">cusror</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="pgsql-cleanup-exclude-tables">
<h3>pgsql_cleanup_exclude_tables<a class="headerlink" href="#pgsql-cleanup-exclude-tables" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.pgsql_cleanup_exclude_tables">
<span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.pytest_plugin.</span></span><span class="sig-name descname"><span class="pre">pgsql_cleanup_exclude_tables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#pgsql_cleanup_exclude_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.pgsql_cleanup_exclude_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Redefine this fixture when you don’t need to clean some tables.
For example postgis create table with spatial reference systems. To use postgis you need to
add this fixture with spatial_ref_sys table.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s1">&#39;session&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pgsql_cleanup_exclude_tables</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;public.spatial_ref_sys&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="pgsql-local">
<h3>pgsql_local<a class="headerlink" href="#pgsql-local" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.pgsql_local">
<span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.pytest_plugin.</span></span><span class="sig-name descname"><span class="pre">pgsql_local</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#pgsql_local"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.pgsql_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures local pgsql instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig" title="testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServiceLocalConfig</span></code></a> instance.</p>
</dd>
</dl>
<p>In order to use pgsql fixture you have to override pgsql_local()
in your local conftest.py file, example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s1">&#39;session&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pgsql_local</span><span class="p">(</span><span class="n">pgsql_local_create</span><span class="p">):</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="n">discover</span><span class="o">.</span><span class="n">find_schemas</span><span class="p">(</span>
        <span class="s1">&#39;service_name&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">PG_SCHEMAS_PATH</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pgsql_local_create</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">databases</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
<p>Sometimes it is desirable to have tests-only database, maybe used in one
particular test or tests group. This can be achieved by by overriding
<code class="docutils literal notranslate"><span class="pre">pgsql_local</span></code> fixture in your test file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">pgsql_local</span><span class="p">(</span><span class="n">pgsql_local_create</span><span class="p">):</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="n">discover</span><span class="o">.</span><span class="n">find_schemas</span><span class="p">(</span>
        <span class="s1">&#39;testsuite&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;custom/pgsql/schema/path&#39;</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">pgsql_local_create</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">databases</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pgsql_local</span></code> provides access to PostgreSQL connection parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_custom_connection_string</span><span class="p">(</span><span class="n">pgsql_local</span><span class="p">):</span>
    <span class="n">conninfo</span> <span class="o">=</span> <span class="n">pgsql_local</span><span class="p">[</span><span class="s1">&#39;database_name&#39;</span><span class="p">]</span>
    <span class="n">custom_dsn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">conninfo</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="s1">&#39;-c opt=val&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_dsn</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">custom_dsn</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="pgsql-local-create">
<h3>pgsql_local_create<a class="headerlink" href="#pgsql-local-create" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.pgsql_local_create">
<span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.pytest_plugin.</span></span><span class="sig-name descname"><span class="pre">pgsql_local_create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">databases</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#pgsql_local_create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.pgsql_local_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates pgsql configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>databases</strong> – List of databases.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig" title="testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServiceLocalConfig</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="marks">
<h2>Marks<a class="headerlink" href="#marks" title="Permalink to this heading">¶</a></h2>
<section id="pytest-mark-pgsql">
<h3>pytest.mark.pgsql<a class="headerlink" href="#pytest-mark-pgsql" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.pytest.mark.pgsql">
<span class="sig-prename descclassname"><span class="pre">pytest.mark.</span></span><span class="sig-name descname"><span class="pre">pgsql</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directories</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.pytest.mark.pgsql" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this mark to override specify extra data fixtures in a per-test manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbname</strong> – Database name.</p></li>
<li><p><strong>files</strong> – List of filenames to apply to the database.</p></li>
<li><p><strong>directories</strong> – List of directories to apply to the database.</p></li>
<li><p><strong>directories</strong> – List of queries to apply to the database.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.pytest_plugin.</span></span><span class="sig-name descname"><span class="pre">ServiceLocalConfig</span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#ServiceLocalConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><span class="pre">PgConnectionInfo</span></a></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/pytest_plugin/#ServiceLocalConfig.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.pytest_plugin.ServiceLocalConfig.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get
<a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">testsuite.databases.pgsql.connection.PgConnectionInfo</span></code></a>
instance by database name</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.connection.PgConnectionInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.connection.</span></span><span class="sig-name descname"><span class="pre">PgConnectionInfo</span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/connection/#PgConnectionInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>PostgreSQL connection parameters</p>
<dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.connection.PgConnectionInfo.get_dsn">
<span class="sig-name descname"><span class="pre">get_dsn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/connection/#PgConnectionInfo.get_dsn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.connection.PgConnectionInfo.get_dsn" title="Permalink to this definition">¶</a></dt>
<dd><p>PostgreSQL connection string in DSN format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.connection.PgConnectionInfo.get_uri">
<span class="sig-name descname"><span class="pre">get_uri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/connection/#PgConnectionInfo.get_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.connection.PgConnectionInfo.get_uri" title="Permalink to this definition">¶</a></dt>
<dd><p>PostgreSQL connection string in URI format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.connection.PgConnectionInfo.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><span class="pre">PgConnectionInfo</span></a></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/connection/#PgConnectionInfo.replace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.connection.PgConnectionInfo.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">PgConnectionInfo</span></code></a> value replacing specified
fields with new values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.control.PgDatabaseWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">testsuite.databases.pgsql.control.</span></span><span class="sig-name descname"><span class="pre">PgDatabaseWrapper</span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/control/#PgDatabaseWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.control.PgDatabaseWrapper.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">connection</span></em><a class="headerlink" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper.conn" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">psycopg2.extensions.connection</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.control.PgDatabaseWrapper.conninfo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conninfo</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><span class="pre">PgConnectionInfo</span></a></em><a class="headerlink" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper.conninfo" title="Permalink to this definition">¶</a></dt>
<dd><p>returns
<a class="reference internal" href="#testsuite.databases.pgsql.connection.PgConnectionInfo" title="testsuite.databases.pgsql.connection.PgConnectionInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">testsuite.databases.pgsql.connection.PgConnectionInfo</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.control.PgDatabaseWrapper.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">cursor</span></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/control/#PgDatabaseWrapper.cursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper.cursor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">psycopg2.extensions.cursor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="testsuite.databases.pgsql.control.PgDatabaseWrapper.dict_cursor">
<span class="sig-name descname"><span class="pre">dict_cursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">cursor</span></span></span><a class="reference internal" href="../_modules/testsuite/databases/pgsql/control/#PgDatabaseWrapper.dict_cursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#testsuite.databases.pgsql.control.PgDatabaseWrapper.dict_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary cursor, see psycopg2.extras.DictCursor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">psycopg2.extensions.cursor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/">API reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../databases/">Database support</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../mongo/">Mongo</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">PostgreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mysql/">MySQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../redis/">Redis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clickhouse/">ClickHouse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rabbitmq/">RabbitMQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/README/">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/">License</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../">Documentation overview</a><ul>
  <li><a href="../databases/">Database support</a><ul>
      <li>Previous: <a href="../mongo/" title="previous chapter">Mongo</a></li>
      <li>Next: <a href="../mysql/" title="next chapter">MySQL</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020-2024, Yandex LLC.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/postgresql.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>